# Retrieve AWS Instance Metadata:

This bash script accepts the metadata key as input and retrives the data value in json output


## Usage 

Run the bash script within AWS instance and provide input data key from listed options

If given metadata is not available, the script will throw an error 


## Example

```bash
./metadata.sh

Enter the metadata type of your choice from above list [Prints all if empty]:

metadata_type: public-hostname

output:
[
  "ec2-54-164-96-138.compute-1.amazonaws.com"
]


```



## Input Arguments:

The following table lists the categories of instance metadata:

| Data Name                                                  | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ---------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| ami-id                                                     | The AMI ID used to launch the instance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ami-launch-index                                           | If you started more than one instance at the same time, this value indicates the order in which the instance was launched. The value of the first instance launched is 0.                                                                                                                                                                                                                                                                                                                                                      |
| ami-manifest-path                                          | The path to the AMI manifest file in Amazon S3. If you used an Amazon EBS-backed AMI to launch the instance, the returned result is unknown.                                                                                                                                                                                                                                                                                                                                                                                   |
| ancestor-ami-ids                                           | The AMI IDs of any instances that were rebundled to create this AMI. This value will only exist if the AMI manifest file contained an ancestor-amis key.                                                                                                                                                                                                                                                                                                                                                                       |
| block-device-mapping/ami                                   | The virtual device that contains the root/boot file system.                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| block-device-mapping/ebsN                                  | The virtual devices associated with any Amazon EBS volumes. Amazon EBS volumes are only available in metadata if they were present at launch time or when the instance was last started. The N indicates the index of the Amazon EBS volume (such as ebs1 or ebs2).                                                                                                                                                                                                                                                            |
| block-device-mapping/ephemeralN                            | The virtual devices for any non-NVMe instance store volumes. The N indicates the index of each volume. The number of instance store volumes in the block device mapping might not match the actual number of instance store volumes for the instance. The instance type determines the number of instance store volumes that are available to an instance. If the number of instance store volumes in a block device mapping exceeds the number available to an instance, the additional instance store volumes are ignored.   |
| block-device-mapping/root                                  | The virtual devices or partitions associated with the root devices or partitions on the virtual device, where the root (/ or C:) file system is associated with the given instance.                                                                                                                                                                                                                                                                                                                                            |
| block-device-mapping/swap                                  | The virtual devices associated with swap. Not always present.                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| elastic-gpus/associations/elastic-gpu-id                   | If there is an Elastic GPU attached to the instance, contains a JSON string with information about the Elastic GPU, including its ID and connection information.                                                                                                                                                                                                                                                                                                                                                               |
| elastic-inference/associations/eia-id                      | If there is an Elastic Inference accelerator attached to the instance, contains a JSON string with information about the Elastic Inference accelerator, including its ID and type.                                                                                                                                                                                                                                                                                                                                             |
| events/maintenance/history                                 | If there are completed or canceled maintenance events for the instance, contains a JSON string with information about the events. For more information, see [To view event history about completed or canceled events](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/monitoring-instances-status-check_sched.html#viewing-event-history).                                                                                                                                                                                |
| events/maintenance/scheduled                               | If there are active maintenance events for the instance, contains a JSON string with information about the events. For more information, see [View scheduled events](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/monitoring-instances-status-check_sched.html#viewing_scheduled_events).                                                                                                                                                                                                                               |
| events/recommendations/rebalance                           | The approximate time, in UTC, when the EC2 instance rebalance recommendation notification is emitted for the instance. The following is an example of the metadata for this category: {"noticeTime": "2020-11-05T08:22:00Z"}. This category is available only after the notification is emitted. For more information, see [EC2 instance rebalance recommendations](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/rebalance-recommendations.html).                                                                       |
| hostname                                                   | The private IPv4 DNS hostname of the instance. In cases where multiple network interfaces are present, this refers to the eth0 device (the device for which the device number is 0).                                                                                                                                                                                                                                                                                                                                           |
| iam/info                                                   | If there is an IAM role associated with the instance, contains information about the last time the instance profile was updated, including the instance's LastUpdated date, InstanceProfileArn, and InstanceProfileId. Otherwise, not present.                                                                                                                                                                                                                                                                                 |
| iam/security-credentials/role-name                         | If there is an IAM role associated with the instance, role-name is the name of the role, and role-name contains the temporary security credentials associated with the role (for more information, see [Retrieve security credentials from instance metadata](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#instance-metadata-security-credentials)). Otherwise, not present.                                                                                                              |
| identity-credentials/ec2/info                              | \[Internal use only\] Information about the credentials in identity-credentials/ec2/security-credentials/ec2-instance. These credentials are used by AWS features such as EC2 Instance Connect, and do not have any additional AWS API permissions or privileges beyond identifying the instance.                                                                                                                                                                                                                              |
| identity-credentials/ec2/security-credentials/ec2-instance | \[Internal use only\] Credentials that allow on-instance software to identify itself to AWS to support features such as EC2 Instance Connect. These credentials do not have any additional AWS API permissions or privileges.                                                                                                                                                                                                                                                                                                  |
| instance-action                                            | Notifies the instance that it should reboot in preparation for bundling. Valid values: none | shutdown | bundle-pending.                                                                                                                                                                                                                                                                                                                                                                                                       |
| instance-id                                                | The ID of this instance.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| instance-life-cycle                                        | The purchasing option of this instance. For more information, see [Instance purchasing options](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-purchasing-options.html).                                                                                                                                                                                                                                                                                                                                         |
| instance-type                                              | The type of instance. For more information, see [Instance types](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-types.html).                                                                                                                                                                                                                                                                                                                                                                                     |
| kernel-id                                                  | The ID of the kernel launched with this instance, if applicable.                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| local-hostname                                             | The private IPv4 DNS hostname of the instance. In cases where multiple network interfaces are present, this refers to the eth0 device (the device for which the device number is 0).                                                                                                                                                                                                                                                                                                                                           |
| local-ipv4                                                 | The private IPv4 address of the instance. In cases where multiple network interfaces are present, this refers to the eth0 device (the device for which the device number is 0).                                                                                                                                                                                                                                                                                                                                                |
| mac                                                        | The instance's media access control (MAC) address. In cases where multiple network interfaces are present, this refers to the eth0 device (the device for which the device number is 0).                                                                                                                                                                                                                                                                                                                                       |
| metrics/vhostmd                                            | No longer available.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| network/interfaces/macs/mac/device-number                  | The unique device number associated with that interface. The device number corresponds to the device name; for example, a device-number of 2 is for the eth2 device. This category corresponds to the DeviceIndex and device-index fields that are used by the Amazon EC2 API and the EC2 commands for the AWS CLI.                                                                                                                                                                                                            |
| network/interfaces/macs/mac/interface-id                   | The ID of the network interface.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| network/interfaces/macs/mac/ipv4-associations/public-ip    | The private IPv4 addresses that are associated with each public IP address and assigned to that interface.                                                                                                                                                                                                                                                                                                                                                                                                                     |
| network/interfaces/macs/mac/ipv6s                          | The IPv6 addresses associated with the interface. Returned only for instances launched into a VPC.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| network/interfaces/macs/mac/local-hostname                 | The interface's local hostname.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| network/interfaces/macs/mac/local-ipv4s                    | The private IPv4 addresses associated with the interface.                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| network/interfaces/macs/mac/mac                            | The instance's MAC address.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| network/interfaces/macs/mac/network-card-index             | The index of the network card. Some instance types support multiple network cards.                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| network/interfaces/macs/mac/owner-id                       | The ID of the owner of the network interface. In multiple-interface environments, an interface can be attached by a third party, such as Elastic Load Balancing. Traffic on an interface is always billed to the interface owner.                                                                                                                                                                                                                                                                                              |
| network/interfaces/macs/mac/public-hostname                | The interface's public DNS (IPv4). This category is only returned if the enableDnsHostnames attribute is set to true. For more information, see [Using DNS with Your VPC](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html).                                                                                                                                                                                                                                                                                      |
| network/interfaces/macs/mac/public-ipv4s                   | The public IP address or Elastic IP addresses associated with the interface. There may be multiple IPv4 addresses on an instance.                                                                                                                                                                                                                                                                                                                                                                                              |
| network/interfaces/macs/mac/security-groups                | Security groups to which the network interface belongs.                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| network/interfaces/macs/mac/security-group-ids             | The IDs of the security groups to which the network interface belongs.                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| network/interfaces/macs/mac/subnet-id                      | The ID of the subnet in which the interface resides.                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| network/interfaces/macs/mac/subnet-ipv4-cidr-block         | The IPv4 CIDR block of the subnet in which the interface resides.                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| network/interfaces/macs/mac/subnet-ipv6-cidr-blocks        | The IPv6 CIDR block of the subnet in which the interface resides.                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| network/interfaces/macs/mac/vpc-id                         | The ID of the VPC in which the interface resides.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| network/interfaces/macs/mac/vpc-ipv4-cidr-block            | The primary IPv4 CIDR block of the VPC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| network/interfaces/macs/mac/vpc-ipv4-cidr-blocks           | The IPv4 CIDR blocks for the VPC.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| network/interfaces/macs/mac/vpc-ipv6-cidr-blocks           | The IPv6 CIDR block of the VPC in which the interface resides.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| placement/availability-zone                                | The Availability Zone in which the instance launched.                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| placement/availability-zone-id                             | The static Availability Zone ID in which the instance is launched. The Availability Zone ID is consistent across accounts. However, it might be different from the Availability Zone, which can vary by account.                                                                                                                                                                                                                                                                                                               |
| placement/group-name                                       | The name of the placement group in which the instance is launched.                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| placement/host-id                                          | The ID of the host on which the instance is launched. Applicable only to Dedicated Hosts.                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| placement/partition-number                                 | The number of the partition in which the instance is launched.                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| placement/region                                           | The AWS Region in which the instance is launched.                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| product-codes                                              | AWS Marketplace product codes associated with the instance, if any.                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| public-hostname                                            | The instance's public DNS. This category is only returned if the enableDnsHostnames attribute is set to true. For more information, see [Using DNS with Your VPC](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html) in the Amazon VPC User Guide.                                                                                                                                                                                                                                                                 |
| public-ipv4                                                | The public IPv4 address. If an Elastic IP address is associated with the instance, the value returned is the Elastic IP address.                                                                                                                                                                                                                                                                                                                                                                                               |
| public-keys/0/openssh-key                                  | Public key. Only available if supplied at instance launch time.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ramdisk-id                                                 | The ID of the RAM disk specified at launch time, if applicable.                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| reservation-id                                             | The ID of the reservation.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| security-groups                                            | The names of the security groups applied to the instance.<br>After launch, you can change the security groups of the instances. Such changes are reflected here and in network/interfaces/macs/mac/security-groups.                                                                                                                                                                                                                                                                                                            |
| services/domain                                            | The domain for AWS resources for the Region.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| services/partition                                         | The partition that the resource is in. For standard AWS Regions, the partition is aws. If you have resources in other partitions, the partition is aws-partitionname. For example, the partition for resources in the China (Beijing) Region is aws-cn.                                                                                                                                                                                                                                                                        |
| spot/instance-action                                       | The action (hibernate, stop, or terminate) and the approximate time, in UTC, when the action will occur. This item is present only if the Spot Instance has been marked for hibernate, stop, or terminate. For more information, see [instance-action](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-interruptions.html#instance-action-metadata).                                                                                                                                                                  |
| spot/termination-time                                      | The approximate time, in UTC, that the operating system for your Spot Instance will receive the shutdown signal. This item is present and contains a time value (for example, 2015-01-05T18:02:00Z) only if the Spot Instance has been marked for termination by Amazon EC2. The termination-time item is not set to a time if you terminated the Spot Instance yourself. For more information, see [termination-time](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/spot-interruptions.html#termination-time-metadata). |




